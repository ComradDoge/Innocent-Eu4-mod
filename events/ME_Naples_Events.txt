namespace = ME_Naples_Events

country_event = { #The Fate of Naples
	id = ME_Naples_Events.1
	title = ME_Naples_Events.1.T
	desc = ME_Naples_Events.1.D
	picture = CIVIL_WAR_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Naples_Events.1.OPT1
		ai_chance = {
			factor = 25
			modifier = {
				factor = 4
				has_opinion = {
					who = FRA
					value = 100
				}
				FRA = {
					has_opinion = {
						who = NAP
						value = 100
					}
				}
			}
		}
		FRA = {
			country_event = {
				id = ME_Naples_Events.2
				days = 60
			}
		}
	}

	option = {
		name = ME_Naples_Events.1.OPT2
		ai_chance = {
			factor = 25
			modifier = {
				factor = 4
				has_opinion = {
					who = HAB
					value = 100
				}
				HAB = {
					has_opinion = {
						who = NAP
						value = 100
					}
				}
			}
		}
		HAB = {
			country_event = {
				id = ME_Naples_Events.3
				days = 60
			}
		}
	}

	option = {
		name = ME_Naples_Events.1.OPT3
		ai_chance = {
			factor = 25
			modifier = {
				factor = 4
				has_opinion = {
					who = TUR
					value = 100
				}
				TUR = {
					has_opinion = {
						who = NAP
						value = 100
					}
				}
			}
		}
		TUR = {
			country_event = {
				id = ME_Naples_Events.4
				days = 60
			}
		}
	}

	option = {
		name = ME_Naples_Events.1.OPT4
		ai_chance = {
			factor = 25 
			modifier = {
				factor = 4
			}			
		}
		add_prestige = 10
	}
}

country_event = { # For France
	id = ME_Naples_Events.2
	title = ME_Naples_Events.2.T
	desc = ME_Naples_Events.2.D
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes
	major = yes

	option = {
		name = ME_Naples_Events.2.OPT1
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				is_rival = ARA
			}
		}

		ARA = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellionAra
			}
			add_historical_rival = ROOT
		}
		ROOT = {
			add_years_of_income = -1
			add_yearly_manpower = -1
			add_opinion = {
				who = FROM
				modifier = nap_helped_rebellion
			}
			add_opinion = {
				who = ARA
				modifier = nap_helped_rebellionAra
			}
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellion
			}
			add_years_of_income = 1
			add_yearly_manpower = 1
			create_general = {
				tradition = 75
			}
			capital_scope = {
				infantry = FROM
				infantry = FROM
				infantry = FROM
			}
		}
		add_historical_rival = ARA
	}

	option = {
		name = ME_Naples_Events.2.OPT2
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				OR = {
					has_opinion = {
						who = NAP
						value = 100
					}
					is_rival = ARA
					army_strength = {
						who = ARA
						value = 0.75
					}
				}
			}
		}
		add_historical_friend = FROM
		add_historical_rival = ARA
		add_opinion = {
			who = FROM
			modifier = nap_helped_rebellion_war
		}
		add_opinion = {
			who = ARA
			modifier = nap_helped_rebellion_warAra
		}
		add_trust = {
			who = NAP
			value = 75
			mutual = yes
		}
		ARA = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellion_warAra
			}
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellion_war
			}
			set_country_flag = naples_france_helped_war
		}
	}

	option = {
		name = ME_Naples_Events.2.OPT3
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				alliance_with = ARA
			}
		}
		add_opinion = {
			who = FROM
			modifier = nap_denied_help
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = nap_denied_help
			}
			country_event = {
				id = ME_Naples_Events.1
				days = 30
			}
		}
	}
}

country_event = { # For Austria
	id = ME_Naples_Events.3
	title = ME_Naples_Events.3.T
	desc = ME_Naples_Events.3.D
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes
	major = yes

	option = {
		name = ME_Naples_Events.3.OPT1
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				has_opinion = {
					who = NAP
					value = 100
				}
			}
		}
		ARA = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellionAra
			}
			add_historical_rival = ROOT
		}
		ROOT = {
			add_years_of_income = -1
			add_yearly_manpower = -1
			add_opinion = {
				who = FROM
				modifier = nap_helped_rebellion
			}
			add_opinion = {
				who = ARA
				modifier = nap_helped_rebellionAra
			}
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellion
			}
			add_years_of_income = 1
			add_yearly_manpower = 1
			create_general = {
				tradition = 75
			}
			capital_scope = {
				infantry = FROM
				infantry = FROM
				infantry = FROM
			}
		}
		add_historical_rival = ARA
	}

	option = {
		name = ME_Naples_Events.3.OPT2
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				OR = {
					has_opinion = {
						who = NAP
						value = 100
					}
					is_at_war = no
					army_strength = {
						who = ARA
						value = 0.66
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					army_strength = {
						who = ARA
						value = 0.50
					}
				}
			}
		}
		add_historical_friend = FROM
		add_historical_rival = ARA
		add_opinion = {
			who = FROM
			modifier = nap_helped_rebellion_war
		}
		add_opinion = {
			who = ARA
			modifier = nap_helped_rebellion_warAra
		}
		add_trust = {
			who = NAP
			value = 75
			mutual = yes
		}
		ARA = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellion_warAra
			}
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellion_war
			}
			set_country_flag = naples_france_helped_war
		}
	}

	option = {
		name = ME_Naples_Events.3.OPT3
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				NOT = {
					army_strength = {
						who = ARA
						value = 0.50
					}
				}
			}
		}
		add_opinion = {
			who = FROM
			modifier = nap_denied_help
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = nap_denied_help
			}
			country_event = {
				id = ME_Naples_Events.1
				days = 30
			}
		}
	}
}

country_event = { # For the Ottomans
	id = ME_Naples_Events.4
	title = ME_Naples_Events.4.T
	desc = ME_Naples_Events.4.D
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes
	major = yes

	option = {
		name = ME_Naples_Events.4.OPT1
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				is_rival = ARA
			}
		}
		ARA = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellionAra
			}
			add_historical_rival = ROOT
		}
		ROOT = {
			add_years_of_income = -1
			add_yearly_manpower = -1
			add_opinion = {
				who = FROM
				modifier = nap_helped_rebellion
			}
			add_opinion = {
				who = ARA
				modifier = nap_helped_rebellionAra
			}
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellion
			}
			add_years_of_income = 1
			add_yearly_manpower = 1
			create_general = {
				tradition = 75
			}
			capital_scope = {
				infantry = FROM
				infantry = FROM
				infantry = FROM
			}
		}
		add_historical_rival = ARA
	}

	option = {
		name = ME_Naples_Events.4.OPT2
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				OR = {
					has_opinion = {
						who = NAP
						value = 100
					}
					is_rival = ARA
					army_strength = {
						who = ARA
						value = 0.75
					}
				}
			}
		}
		add_historical_friend = FROM
		add_historical_rival = ARA
		add_opinion = {
			who = FROM
			modifier = nap_helped_rebellion_war
		}
		add_opinion = {
			who = ARA
			modifier = nap_helped_rebellion_warAra
		}
		add_trust = {
			who = NAP
			value = 75
			mutual = yes
		}
		ARA = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellion_warAra
			}
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = nap_helped_rebellion_war
			}
			set_country_flag = naples_france_helped_war
		}
	}

	option = {
		name = ME_Naples_Events.4.OPT3
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				alliance_with = ARA
			}
		}
		add_opinion = {
			who = FROM
			modifier = nap_denied_help
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = nap_denied_help
			}
			country_event = {
				id = ME_Naples_Events.1
				days = 30
			}
		}
	}
}

country_event = { #Restoring the Glory of Greece
	id = ME_Naples_Events.5
	title = ME_Naples_Events.5.T
	desc = ME_Naples_Events.5.D
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Naples_Events.5.OPT1
		
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = {
					num_of_free_diplomatic_relations = 1
				}
			}
		}		
		every_province = {
			limit = {
				NOT = {
					is_core = GRE
				}
				owned_by = ROOT
				culture = greek
			}
			add_core = GRE
		}
		release = GRE
		GRE = {
			set_dynasty = NAP
			change_government = monarchy
			add_government_reform = feudalism_reform
		}
		if = {
			limit = {
				is_expanded_mod_active = { mod = subjects }
			}
			create_subject = {
				subject_type = brother_kingdom
				subject = GRE
			}
		}
		else = { create_march = GRE }
		add_country_modifier = {
			name = nap_subject_tribute
			duration = -1
		}
		northern_greece_area = {
			limit = {
				NOT = {
					is_core = GRE
				}
			}
			add_core = GRE
			add_permanent_claim = GRE
		}
		macedonia_area = {
			limit = {
				NOT = {
					is_core = GRE
				}
			}
			add_core = GRE
			add_permanent_claim = GRE
		}
		morea_area = {
			limit = {
				NOT = {
					is_core = GRE
				}
			}
			add_core = GRE
			add_permanent_claim = GRE
		}		
		aegean_archipelago_area = {
			limit = {
				NOT = {
					is_core = GRE
				}
			}
			add_core = GRE
			add_permanent_claim = GRE
		}
	}

	option = {
		name = ME_Naples_Events.5.OPT2

		ai_chance = {
			factor = 50
		}
		custom_tooltip = NAP_EVENT6_SUBJECT_SLAVE_TOOLTIP
		hidden_effect = {
			every_province = {
				limit = {
					owned_by = ROOT
					region = italy_region
				}
				add_province_modifier = {
					name = nap_subject_slaves
					duration = 9125
				}
			}
		}
	}
}

country_event = { #The Throne of Provence for Provence
	id = ME_Naples_Events.6
	title = ME_Naples_Events.6.T
	desc = ME_Naples_Events.6.D
	picture = COURT_eventPicture
	
	is_triggered_only = yes
	major = yes

	option = {
		name = ME_Naples_Events.6.OPT1

		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				army_strength = {
					who = NAP
					value = 0.50
				}
			}
		}
		FROM = {
			if = {
				limit = {
					is_expanded_mod_active = { mod = subjects }
				}
				create_subject = {
					subject_type = brother_kingdom
					subject = ROOT
				}
			}
			else = {
				create_union = ROOT
			}
		}
	}

	option = {
		name = ME_Naples_Events.6.OPT2

		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				is_subject = yes
			}
		}
		add_casus_belli = {
			type = cb_insult
			target = FROM
		}
		FROM = {
			add_casus_belli = {
				type = cb_restore_personal_union
				months = 300
				target = ROOT
			}
		}
	}
}

country_event = { #The Crown of Jerusalem
	id = ME_Naples_Events.7
	title = ME_Naples_Events.7.T
	desc = ME_Naples_Events.7.D
	picture = GOOD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Naples_Events.7.OPT1
		
		ai_chance = {
			factor = 50
		}
		add_years_of_income = -1
		palestine_area = {
			limit = {
				NOT = { 
					owned_by = ROOT 
				}
			}
			add_permanent_claim = ROOT
		}
		add_country_modifier = {
			name = nap_defender_christianity
			duration = -1
		}
		every_country = {
			limit = {
				religion = catholic
			}
			add_opinion = {
				who = ROOT
				modifier = nap_crown_himself
			}
		}
	}
	option = {
		name = ME_Naples_Events.7.OPT2

		ai_chance = {
			factor = 50
		}
		change_religious_influence_equivalent = {
			add = 25
		}
		if = {
			limit = {
				stability = 3
			}
			add_adm_power = 100
		}
		else_if = {
			add_stability = 1
		}
		every_country = {
			limit = {
				religion = catholic
			}
			add_opinion = {
				who = ROOT
				modifier = nap_refuse_crown
			}
		}
	}
}

country_event = { #Their demands 
	id = ME_Naples_Events.8
	title = ME_Naples_Events.8.T
	desc = ME_Naples_Events.8.D
	picture = DIPLOMACY_eventPicture

	fire_only_once = yes

	trigger = {
		tag = NAP
		is_subject = no
		is_at_war = no
		OR = {
			has_country_flag = naples_france_helped_war
			has_country_flag = naples_austria_helped_war
			has_country_flag = naples_ottomans_helped_war
		}
	}

	option = {
		name = ME_Naples_Events.8.OPT1
		ai_chance = {
			factor = 50
		}
		if = { #if has chosen France help
			limit = {
				has_country_flag = naples_france_helped_war
			}
			if = {
				limit = {
					is_expanded_mod_active = { mod = subjects }
				}
				FRA = {
					create_subject = {
						subject_type = brother_kingdom
						subject = ROOT
					}
				}
			}
			else = {
				ROOT = {
					kill_ruler = yes
					set_dynasty = FRA
				}
				FRA = {
					add_casus_belli = {
						type = cb_restore_personal_union
						months = 300
						target = ROOT
					}
				}
			}
		}

		else_if = { #if has chosen Austrian help
			limit = {
				has_country_flag = naples_austria_helped_war
			}
			HAB = {
				if = {
					limit = {
						is_expanded_mod_active = { mod = subjects }
					}
					create_subject = {
						subject_type = imperial_feud_subject
						subject = ROOT
					}
				}
				else = {
					NAP = {
						set_in_empire = yes 
					}
				}
			}
		}

		else_if = { #if has chosen Ottoman help
			limit = {
				has_country_flag = naples_ottomans_helped_war
			}
			NAP = {
				release = SIC
			}
			SIC = {
				set_dynasty = NAP
				change_government = monarchy
				change_government_via_reform = feudalism_reform
			}
			TUR = {
				if = {
					limit = {
						is_expanded_mod_active = { mod = subjects }
					}
					create_subject = {
						subject_type = muslim_tributary_vassal
						subject = SIC
					}
				}
				else = { 
					create_march = SIC 
				}
			}
		}
	}

	option = {
		name = ME_Naples_Events.8.OPT2
		ai_chance = {
			factor = 50
		}
		if = { #if has chosen France help
			limit = {
				has_country_flag = naples_france_helped_war
			}
			FRA = {
				add_casus_belli = {
					target = ROOT
					type = cb_annex
					months = 300
				}
			}
		}

		else_if = { #if has chosen Austrian help
			limit = {
				has_country_flag = naples_austria_helped_war
			}
			HAB = {
				add_casus_belli = {
					target = ROOT
					type = cb_annex
					months = 300
				}
			}
		}

		else_if = { #if has chosen Ottoman help
			limit = {
				has_country_flag = naples_ottomans_helped_war
			}
			TUR = {
				add_casus_belli = {
					target = ROOT
					type = cb_annex
					months = 300
				}
			}
		}
	}
}

country_event = { #Coronation Day
	id = ME_Naples_Events.9
	title = ME_Naples_Events.9.T
	desc = ME_Naples_Events.9.D
	picture = GOOD_WITH_MONARCH_eventPicture

	fire_only_once = yes
	is_triggered_only = yes

	mean_time_to_happen = {
		months = 1
	}

	trigger = {
		tag = NAP
		is_subject = no
		is_at_war = no
	}

	option = {
		name = ME_Naples_Events.9.OPT1
		ai_chance = {
			factor = 100
		}
		add_prestige = 25
		add_legitimacy = 25
		set_country_flag = nap_coronated
		if = {
			limit = {
				has_heir = yes
			}
			kill_heir = yes
			define_ruler = {
				name = "Carlo I"
				dynasty = "Borbone"
				adm = 4
				dip = 6
				mil = 5
				age = 20
				claim = 100
				fixed = yes
			}
		}
	}
}

country_event = { #A request from Naples
	id = ME_Naples_Events.10
	title = ME_Naples_Events.10.T
	desc = ME_Naples_Events.10.D
	picture = POPE_PREACHING_eventPicture

	major = yes
	is_triggered_only = yes

	option = {
		name = ME_Naples_Events.10.OPT1
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				OR = {
					alliance_with = PAP
					has_opinion = {
						who = PAP
						value = 125
					}
					PAP = {
						has_opinion = {
							who = ROOT
							value = 125
						}
					}
				}
			}
		}
		add_historical_friend = FROM
		FROM = {
			add_historical_friend = ROOT
			add_years_of_income = -1
		}
		add_years_of_income = 1
		emilia_romagna_area = {
			limit = {
				owned_by = ROOT
				NOT = {
					is_core = FROM
				}
			}
			add_core = FROM
			cede_province = FROM
			remove_core = ROOT
		}
	}
	option = {
		name = ME_Naples_Events.10.OPT2
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				OR = {
					has_opinion = {
						who = PAP
						value = 100
					}
					PAP = {
						has_opinion = {
							who = ROOT
							value = 100
						}
					}
				}
			}
		}
		FROM = {
			add_years_of_income = -1
		}
		add_years_of_income = 1
		central_italy_area = {
			limit = {
				owned_by = ROOT
				has_port = yes
				NOT = {
					is_core = FROM
				}
			}
			add_core = FROM
			cede_province = FROM
			remove_core = ROOT
		}
	}

	option = {
		name = ME_Naples_Events.10.OPT3
		ai_chance = {
			factor = 33
			modifier = {
				factor = 3
				OR = {
					is_rival = PAP
					NOT = {
						has_opinion = {
							who = PAP
							value = -100
						}
					}
					NOT = {
						PAP = {
							has_opinion = {
								who = ROOT
								value = -100
							}
						}
					}
				}
			}
		}
		if = {
			limit = {
				religion = catholic
				125 = {
					owned_by = ROOT
				}
			}
			125 = { #Palermo
				if = {
					limit = {
						has_cardinal = no
					}
					add_cardinal = yes
				}
				else_if = {
					limit = {
						has_cardinal = yes
						has_building = temple
					}
					remove_building = temple
					add_building_construction = {
						building = cathedral
						speed = 0.75
						cost = 0
					}
				}
				else_if = {
					limit = {
						has_cardinal = yes
					}
					add_building_construction = {
						building = temple
						speed = 0.75
						cost = 0
					}
				}
				else = {
					add_base_tax = 2
				}
			}
		}
		else = {
			FROM = {
				if = {
					limit = {
						religion = catholic
					}
					add_papal_influence = 25
				}
				else = {
					add_legitimacy_equivalent = {

					}
				}
			}
		}
	}
}

country_event = { #The bond with Naples for Hungary
	id = ME_Naples_Events.11
	title = ME_Naples_Events.11.T
	desc = ME_Naples_Events.11.D
	picture = COURT_eventPicture

	major = yes
	
	is_triggered_only = yes

	option = {
		name = ME_Naples_Events.11.OPT1

		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				army_strength = {
					who = NAP
					value = 0.50
				}
			}
		}
		FROM = {
			if = {
				limit = {
					is_expanded_mod_active = { mod = subjects }
				}
				create_subject = {
					subject_type = brother_kingdom
					subject = ROOT
				}
			}
			else = {
				create_union = ROOT
			}
		}
	}

	option = {
		name = ME_Naples_Events.11.OPT2

		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				is_subject = yes
			}
		}
		add_casus_belli = {
			type = cb_insult
			target = FROM
		}
		FROM = {
			add_casus_belli = {
				type = cb_restore_personal_union
				months = 300
				target = ROOT
			}
		}
	}
}

country_event = { #The imperial throne
	id = ME_Naples_Events.12
	title = ME_Naples_Events.12.T
	desc = ME_Naples_Events.12.D
	picture = GOOD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	mean_time_to_happen = {
		months = 1
	}

	trigger = {
		tag = NAP
		is_subject = no
		is_at_war = no
	}

	option = {
		name = ME_Naples_Events.12.OPT1
		ai_chance = {
			factor = 50
		}
		set_country_flag = nap_imperial_throne_accepted
	}
	option = {
		name = ME_Naples_Events.12.OPT2
		ai_chance = {
			factor = 50
		}
		
	}
}