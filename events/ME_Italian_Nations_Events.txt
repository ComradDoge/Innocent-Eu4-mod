namespace = ME_Italian_Nations_Events

country_event = { # The Occupation of Rome Hidden Save
	id = ME_Italian_Nations_Events.1
	title = ME_Italian_Nations_Events.1.N
	desc = ME_Italian_Nations_Events.1.D
	picture = HRE_eventPicture
	
	hidden = yes
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			save_global_event_target_as = country_ruling_italy_yes
		}
	}
	
	option = {
		name = ME_Italian_Nations_Events.1.OPT1
		ai_chance = { 
			factor = 100
		}
	}
}

country_event = { # The Occupation of Rome
	id = ME_Italian_Nations_Events.2
	title = ME_Italian_Nations_Events.2.N
	desc = ME_Italian_Nations_Events.2.D
	picture = HRE_eventPicture

	major = yes
	is_triggered_only = yes
	
	option = {
		name = ME_Italian_Nations_Events.2.OPT1
		ai_chance = { 
			factor = 33
			modifier = {
				factor = 3
				OR = {
					tag = PAP
					NOT = {
						has_opinion = {
							who = ROOT
							value = -100
						}
					}
				}
			}
		}

		set_country_flag = ruling_italy_no
		add_opinion = {
			who = FROM
			modifier = italian_nations_ruling_no
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = italian_nations_ruling_no
			}
		}
		custom_tooltip = italian_nations_ruling_no_tooltip
	}
	
	option = {
		name = ME_Italian_Nations_Events.2.OPT2
		ai_chance = { 
			factor = 33
			modifier = {
				factor = 3
				OR = {
					NOT = {
						army_strength = {
							who = FROM
							value = 1
						}
					}
					alliance_with = FROM
					has_opinion = {
						who = FROM
						value = 125
					}
				}
			}
		}

		trigger = {
			NOT = {
				tag = PAP
			}
		}
		set_country_flag = ruling_italy_yes
		add_trust = {
			who = FROM
			value = 25
			mutual = yes
		}
		add_opinion = {
			who = FROM
			modifier = italian_nations_ruling_yes
		}
		FROM = {
			add_opinion = {
				who = ROOT
				modifier = italian_nations_ruling_yes
			}
		}
		custom_tooltip = italian_nations_ruling_yes_tooltip
	}

	option = {
		name = ME_Italian_Nations_Events.2.OPT3
		ai_chance = { 
			factor = 33
			modifier = {
				factor = 3
				AND = {
					has_opinion = {
						who = FROM
						value = 50
					}
					NOT = {
						has_opinion = {
							who = FROM
							value = -50
						}
					}
				}
			}
		}

		custom_tooltip = italian_nations_ruling_nothing_tooltip
	}
}

country_event = {
	id = ME_Italian_Nations_Events.100
	title = ME_Italian_Nations_Events.100.N
	desc = ME_Italian_Nations_Events.100.D
	picture = HRE_eventPicture

	mean_time_to_happen = {
		days = 90
	}

	major = yes
	is_triggered_only = yes
	
	trigger = {
		OR = {
			is_emperor = yes
			tag = PAP
		}
		is_year = 1440
		NOT = {
			is_year = 1490
		}
		NOT = {
			has_country_flag = pope_emperor_choice
		}
	}
	
	option = {
		name = ME_Italian_Nations_Events.100.OPT1
		
		ai_chance = { 
			factor = 0.50
		}
		set_country_flag = ruling_italy_yes
		set_country_flag = pope_emperor_choice
	}
	
	option = {
		name = ME_Italian_Nations_Events.100.OPT2
		
		ai_chance = { 
			factor = 0.50
		}
		set_country_flag = ruling_italy_no
		set_country_flag = pope_emperor_choice
	}
}


country_event = { #Muraro of South Italy
	id = ME_Italian_Nations_Events.200
	title = ME_Italian_Nations_Events.200.T
	desc = ME_Italian_Nations_Events.200.D
	picture = TRADEGOODS_eventPicture

	fire_only_once = yes

	trigger = {
		culture_group = latin
		owns_core_province = 112
		owns_core_province = 2976
	}

	option = {
		name = ME_Italian_Nations_Events.200.OPT1
		ai_chance = {
			factor = 50
		}

		358 = {
			change_trade_goods = glass
		}
		if = {
			limit = {
				NOT = { has_building = workshop }
			}
			add_building_construction = {
				building = workshop
				speed = 0.5
				cost = 0
			}
		}
		else_if = {
			limit = {
				NOT = { has_building = counting_house }
			}
			remove_building = workshop
			add_building_construction = {
				building = counting_house
				speed = 0.5
				cost = 0
			}
		}
		else = { add_base_production = 4 }
	}
}